<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<!-- <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css"> -->
<link rel="shortcut icon" href="/assets/favicon.ico">
<title>archive</title>
<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>archive - 求索</title>
<meta property="og:title" content="archive" />
<meta name="description" content="尔不必求记，却宜求个明白！" />
<meta property="og:description" content="尔不必求记，却宜求个明白！" />
<link rel="canonical" href="http://localhost:4000/pages/archive.html" />
<meta property="og:url" content="http://localhost:4000/pages/archive.html" />
<meta property="og:site_name" content="求索" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "WebPage",
"headline": "archive",
"description": "尔不必求记，却宜求个明白！",
"url": "http://localhost:4000/pages/archive.html"}</script>
<!-- End Jekyll SEO tag -->
</head>

<body>
	<main class="container">
		<section class="about">
			<a href="/"><img src="/assets/profile.png" alt="Mingxu.Xie"></a>
			<h2>Mingxu.Xie</h2>
			<p class="tagline">Devops</p>
			<ul class="social">
				<a href="https://github.com/xiemx">
					<li><i class="icon-github-circled"></i></li>
				</a>
				<a href="https://www.linkedin.com/in/xiemx1991">
					<li><i class="icon-linkedin-squared"></i></li>
				</a>
				<a href="https://twitter.com/xiemx1991">
					<li><i class="icon-twitter-squared"></i></li>
				</a>
			</ul>
			<p>&copy; 尔不必求记，却宜求个明白！</p>
			<div>
				<div class="categories">
					<h4>Categories</h4>
					<ul>
						<a href="/">
							<li>Index</li>
						</a>
						<a href="/pages/about.html">
							<li>About</li>
						</a>
						<a href="/pages/archive.html">
							<li>Archive</li>
						</a>
						<a href="/blog/">
							<li>Blogs</li>
						</a>
						<a href="/pages/commands.html">
							<li>Commands</li>
						</a>
					</ul>
				</div>
				<div class="tags" style="width:200px;white-space:normal">
					<h4>Tag Cloud:</h4>
					<a href="/tag/cluster/" class="set-1">cluster</a> <a href="/tag/command/" class="set-1">command</a> <a href="/tag/deployment/" class="set-1">deployment</a> <a href="/tag/domain/" class="set-1">domain</a> <a href="/tag/http/" class="set-1">http</a> <a href="/tag/iis/" class="set-1">iis</a> <a href="/tag/issue/" class="set-1">issue</a> <a href="/tag/memcache/" class="set-1">memcache</a> <a href="/tag/mime-type/" class="set-1">mime-type</a> <a href="/tag/mongo/" class="set-1">mongo</a> <a href="/tag/monitor/" class="set-1">monitor</a> <a href="/tag/mysql/" class="set-1">mysql</a> <a href="/tag/python/" class="set-1">python</a> <a href="/tag/scripts/" class="set-1">scripts</a> <a href="/tag/shell/" class="set-1">shell</a> <a href="/tag/statuscode/" class="set-1">statusCode</a> <a href="/tag/uwsgi/" class="set-1">uwsgi</a> <a href="/tag/vagrant/" class="set-1">vagrant</a> <a href="/tag/vcenter/" class="set-1">vcenter</a> <a href="/tag/windows/" class="set-2">windows</a> <a href="/tag/zabbix/" class="set-5">zabbix</a> <a href="/tag/zentaopms/" class="set-1">zentaopms</a>
				</div>
			</div>
		</section>
		<section class="content">
			<div class="post-container">
    <div class="post">
        <h3 id="archives">Archives</h3>
<ul>
  
  <li>
    <a href="/2017/09/21/zabbix-distrubuted-monitor">zabbix distrubuted monitor</a>
   <!-- <p><p>zabbix 分布式监控2种模式</p>
<ul>
  <li>node模式</li>
  <li>proxy模式</li>
</ul>

</p> -->
  </li>
  
  <li>
    <a href="/2017/02/09/vagrant-mulit-vm">vagrant创建多个虚拟机</a>
   <!-- <p><p>建立多台VM，並且让他们之间能够相通信，一台是应用服务器、一台是DB服务器,参考如下</p>

</p> -->
  </li>
  
  <li>
    <a href="/2017/02/09/vagrant">vagrant使用</a>
   <!-- <p><p>删除文档，参考官方：<a href="https://www.vagrantup.com/docs/cli/">https://www.vagrantup.com/docs/cli/</a></p>
</p> -->
  </li>
  
  <li>
    <a href="/2017/02/09/vagrantfile">Vagrantfile配置</a>
   <!-- <p><p>删除原始文档，参考官方文档：<a href="https://www.vagrantup.com/docs/vagrantfile/">https://www.vagrantup.com/docs/vagrantfile/</a></p>
</p> -->
  </li>
  
  <li>
    <a href="/2017/01/19/vcenter-expand-disk-to-linux">vcenter扩容Linux虚拟机磁盘</a>
   <!-- <p><p><img src="/assets/image/img_58802ffca93b9.png" alt="img" /></p>

</p> -->
  </li>
  
  <li>
    <a href="/2017/01/12/vcenter-expand-disk-to-windows">vcenter扩容window磁盘</a>
   <!-- <p><p>1.vcenter中增加磁盘大小，原本是80G现在扩容100G</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/12/19/zabbix-monitor-redis">zabbix监控redis</a>
   <!-- <p><p>可配合zabbix自动发现，来完成自动监控</p>

<h3 id="scripts">scripts</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>redis.sh
<span class="c">#!/bin/bash</span>
<span class="nv">redis_conn</span><span class="o">=</span><span class="s2">"/usr/local/bin/redis-cli"</span>
<span class="nv">port</span><span class="o">=</span><span class="nv">$1</span>

<span class="k">case</span> <span class="nv">$2</span> <span class="k">in</span> 
  <span class="s2">"used_memory"</span><span class="p">)</span>
    <span class="nv">used_memory</span><span class="o">=</span><span class="sb">`</span><span class="nv">$redis_conn</span> <span class="nt">-p</span> <span class="nv">$port</span> info | <span class="nb">grep </span>used_memory:|awk <span class="nt">-F</span><span class="s1">':'</span> <span class="s1">'{print $2}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$used_memory</span>
    <span class="p">;;</span>
  <span class="s2">"ops_sec"</span><span class="p">)</span>
    <span class="nv">ops</span><span class="o">=</span><span class="sb">`</span><span class="nv">$redis_conn</span> <span class="nt">-p</span> <span class="nv">$port</span> info|grep instantaneous_ops_per_sec:|awk <span class="nt">-F</span><span class="s1">':'</span> <span class="s1">'{print $2}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$ops</span>
    <span class="p">;;</span>
  <span class="s2">"connected_clients"</span><span class="p">)</span>
    <span class="nv">connected_clients</span><span class="o">=</span><span class="sb">`</span><span class="nv">$redis_conn</span> <span class="nt">-p</span> <span class="nv">$port</span> info|grep connected_clients: | <span class="nb">awk</span> <span class="nt">-F</span> <span class="s1">':'</span> <span class="s1">'{print $2}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$connected_clients</span>
    <span class="p">;;</span>
  <span class="s2">"blocked_clients"</span><span class="p">)</span>
    <span class="nv">blocked_clients</span><span class="o">=</span><span class="sb">`</span><span class="nv">$redis_conn</span> <span class="nt">-p</span> <span class="nv">$port</span> info|grep blocked_clients:|awk <span class="nt">-F</span><span class="s1">':'</span> <span class="s1">'{print $2}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$blocked_clients</span>
    <span class="p">;;</span> 
  <span class="k">*</span><span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"please input used_memory|ops_sec|connected_clients|blocked_clients"</span>
    <span class="p">;;</span> 
<span class="k">esac</span>
</code></pre></div></div>

<h3 id="conf文件">conf文件</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">cat zabbix_redis.conf</span>

<span class="s">UserParameter=redis[*],/opt/script/zabbix/redis.sh $1 $2</span>
</code></pre></div></div>
</p> -->
  </li>
  
  <li>
    <a href="/2016/12/19/zabbix-monitor-mongo">zabbix监控mongo</a>
   <!-- <p><p>可配合zabbix自动发现，自动监控服务</p>
<h3 id="script">script</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>mongo.sh

<span class="c">#!/bin/bash</span>

<span class="k">case</span> <span class="nv">$1</span> <span class="k">in</span> 
<span class="c">#  use_memory)</span>
<span class="c">#    used_memory=`echo "db.serverStatus().mem"|mongo admin|grep resident|awk -F':' '{print $2}'|tr -d " ,"`</span>
<span class="c">#    echo $used_memory</span>
<span class="c">#    ;;</span>
<span class="c">#  </span>
<span class="c">#  use_vmemory)</span>
<span class="c">#    used_vmemory=`echo "db.serverStatus().mem"|mongo admin|grep virtual|awk -F':' '{print $2}'|tr -d " ,"`</span>
<span class="c">#    echo $used_vmemory</span>
<span class="c">#    ;;</span>
<span class="c">#  </span>
<span class="c">#  used_conn)</span>
<span class="c">#    used_conn=`echo "db.serverStatus().connections"|mongo admin|grep current|awk -F':' '{print $2}'|tr -d ' ,'`</span>
<span class="c">#    echo $used_conn</span>
<span class="c">#    ;;</span>
<span class="c">#  </span>
<span class="c">#  available_conn)</span>
<span class="c">#    available=`echo "db.serverStatus().connections"|mongo admin|grep available|awk -F':' '{print $2}'|tr -d ' ,'`</span>
<span class="c">#    echo $availabe</span>
<span class="c">#  ;;</span>
  
  insert<span class="p">)</span>
    <span class="nv">insert</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $1}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$insert</span>
    <span class="p">;;</span>
  
  query<span class="p">)</span>
    <span class="nv">query</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $2}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$query</span>
    <span class="p">;;</span>
  
  update<span class="p">)</span>
    <span class="nv">update</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $3}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$update</span>
    <span class="p">;;</span>
  
  delete<span class="p">)</span>
    <span class="nv">delete</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $4}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$delete</span>
    <span class="p">;;</span>
  getmore<span class="p">)</span>
    <span class="nv">getmore</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $5}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>  
    <span class="nb">echo</span> <span class="nv">$getmore</span>
    <span class="p">;;</span>
  <span class="nb">command</span><span class="p">)</span>
    <span class="nb">command</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $6}'</span>|awk <span class="nt">-F</span><span class="s1">'|'</span> <span class="s1">'{print $1}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$command</span>
    <span class="p">;;</span>
  vsize<span class="p">)</span>
    <span class="nv">vsize</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $10}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,G'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$vsize</span>
    <span class="p">;;</span>
  res<span class="p">)</span>
    <span class="nv">res</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $11}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,G'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$res</span>
    <span class="p">;;</span>
  qr<span class="p">)</span>
    <span class="nv">qr</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $12}'</span>|awk <span class="nt">-F</span><span class="s1">'|'</span> <span class="s1">'{print $1}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$qr</span>
    <span class="p">;;</span>
  qw<span class="p">)</span>
    <span class="nv">qw</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $12}'</span>|awk <span class="nt">-F</span><span class="s1">'|'</span> <span class="s1">'{print $2}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$qw</span>
    <span class="p">;;</span>
  ar<span class="p">)</span>
    <span class="nv">ar</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $13}'</span>|awk <span class="nt">-F</span><span class="s1">'|'</span> <span class="s1">'{print $1}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$ar</span>
    <span class="p">;;</span>
  aw<span class="p">)</span>
    <span class="nv">aw</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $13}'</span>|awk <span class="nt">-F</span><span class="s1">'|'</span> <span class="s1">'{print $2}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$aw</span>
    <span class="p">;;</span>
  conn<span class="p">)</span>
    <span class="nv">conn</span><span class="o">=</span><span class="sb">`</span>mongostat <span class="nt">-n1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1|awk <span class="s1">'{print $16}'</span>|tr <span class="nt">-d</span> <span class="s1">' *,'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$conn</span>
    <span class="p">;;</span>

  <span class="k">*</span><span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"please input  insert|query|update|delete"</span>
    <span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div></div>

<h3 id="conf配置文件">conf配置文件</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>zabbix_mongo.conf
<span class="nv">UserParameter</span><span class="o">=</span>mongo[<span class="k">*</span><span class="o">]</span>,/opt/script/zabbix/mongo.sh <span class="nv">$1</span>
</code></pre></div></div>
</p> -->
  </li>
  
  <li>
    <a href="/2016/12/19/zabbix-monitor-memcache">zabbix监控memcache</a>
   <!-- <p><h3 id="script">script</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>memcached.sh

<span class="c">#!/bin/bash</span>
<span class="nv">port</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">mem_conn</span><span class="o">=</span><span class="s2">"/bin/nc 127.0.0.1 </span><span class="nv">$port</span><span class="s2">"</span>

<span class="k">case</span> <span class="nv">$2</span> <span class="k">in 
  </span>conn<span class="p">)</span>
    <span class="nv">conn</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep curr_connections | <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$conn</span>
    <span class="p">;;</span>
  bytes<span class="p">)</span>
    <span class="nv">bytes</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep bytes|awk <span class="s1">'{print $3}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="sb">`</span><span class="nb">echo</span> <span class="nv">$bytes</span> |tr <span class="nt">-d</span> <span class="s2">" "</span><span class="sb">`</span>
    <span class="p">;;</span>
  cmd_get<span class="p">)</span>
    <span class="nv">cmd_get</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_get| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$cmd_get</span>
    <span class="p">;;</span>
  cmd_set<span class="p">)</span>
    <span class="nv">cmd_set</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_set| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$cmd_set</span>
    <span class="p">;;</span>
  get_hits<span class="p">)</span>
    <span class="nv">get_hits</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep get_hits| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$get_hits</span>
    <span class="p">;;</span>
  read_qps_sec<span class="p">)</span>
    <span class="nv">count1</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_get| <span class="nb">awk</span> <span class="s1">'{print $3}'</span>|tr <span class="nt">-d</span> <span class="s1">'\r'</span> <span class="sb">`</span>
    <span class="nb">sleep </span>1
    <span class="nv">count2</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_get| <span class="nb">awk</span> <span class="s1">'{print $3}'</span>|tr <span class="nt">-d</span> <span class="s1">'\r'</span> <span class="sb">`</span>
    <span class="nv">count</span><span class="o">=</span><span class="sb">`</span> <span class="nb">expr</span> <span class="nv">$count2</span> - <span class="nv">$count1</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$count</span>
    <span class="p">;;</span>
  write_qps_sec<span class="p">)</span>
    <span class="nv">count1</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_set| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nb">sleep </span>1
    <span class="nv">count2</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_set| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nv">count</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$count2</span> <span class="nv">$count1</span>|awk <span class="s1">'{printf($1-$2)}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$count</span>
    <span class="p">;;</span>
  
  hit_target<span class="p">)</span>
    <span class="nv">cmd_get</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep cmd_get| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nv">get_hits</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"stats</span><span class="se">\n</span><span class="s2">quit"</span>|<span class="nv">$mem_conn</span>|grep get_hits| <span class="nb">awk</span> <span class="s1">'{print $3}'</span> <span class="sb">`</span>
    <span class="nv">hit_target</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$get_hits</span> <span class="nv">$cmd_get</span>|awk <span class="s1">'{printf($1*100/$2)}'</span><span class="sb">`</span>
    <span class="nb">echo</span> <span class="nv">$hit_target</span>
    <span class="p">;;</span>
  <span class="k">*</span><span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"please input conn|bytes|cmd_get|cmd_set|get_hits|read_qps_sec|write_qps_sec|hit_target"</span>
    <span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div></div>

<h3 id="配置文件放到zabbix的confd目录下">配置文件放到zabbix的conf.d/目录下，</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>zabbix_memcache.conf
<span class="nv">UserParameter</span><span class="o">=</span>memcache[<span class="k">*</span><span class="o">]</span>,/opt/script/zabbix/memcached.sh <span class="nv">$1</span> <span class="nv">$2</span>
</code></pre></div></div>
</p> -->
  </li>
  
  <li>
    <a href="/2016/12/05/zabbix-monitor-ssl-cert">zabbix 监控ssl证书过期时间</a>
   <!-- <p><p>脚本是参考网上修改过的版本，注意要指定servername参数，以免抓取到其它站点的证书。</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/12/05/zabbix-trigger-function">zabbix触发器函数</a>
   <!-- <p><p>不再一一列出，参考官方文档</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/11/23/fix-zabbix-item-not-supported">Zabbix自定义Item Not Supported,页面出现不支持解决
</a>
   <!-- <p><p>使用Zabbix的时候往往会自定义Item。
但是经常会遇到自定义的<code class="highlighter-rouge">Item Not Supported</code>了。
Zabbix Agent默认的超时时间是<code class="highlighter-rouge">3</code>秒。往往我们自定义的Item由于各种原因返回时间会比较长。建议修改一个适合自己实际的值。</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/09/01/zabbix-server-configure">zabbix-server.conf文件详解</a>
   <!-- <p><p>```markdown
AlertScriptsPath 默认值：/usr/local/share/zabbix/alertscripts 说明：告警脚本目录</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/08/11/shell-command-watch">watch重复执行某个命令</a>
   <!-- <p><p>当需要重复执行一个命令时，可使用<code class="highlighter-rouge">watch</code></p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/08/09/zabbix-less-than-25-free-in-the-configuration-cache">zabbix Less than 25% free in the configuration cache解决</a>
   <!-- <p><p>在zabbix server默认配置下，出现告警</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/07/27/domain-status-code">域名状态含义</a>
   <!-- <p><p>新注册的域名，可能出现以下状态：</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/07/26/uwsgi-invalid-option-x-getopt_long-error">uwsgi 报错 invalid option --“x” getopt_long() error</a>
   <!-- <p><h3 id="报错">报错：</h3>

</p> -->
  </li>
  
  <li>
    <a href="/2016/06/29/zabbix-alert-to-wechat-script">zabbix微信报警脚本</a>
   <!-- <p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s">'xiemx'</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span><span class="p">,</span><span class="n">requests</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="k">class</span> <span class="nc">Weixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<span class="err">   </span> <span class="k">def</span> <span class="nf">get_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="err">       </span> <span class="n">CorpID</span> <span class="o">=</span> <span class="s">'-------4fa4'</span>
<span class="err">       </span> <span class="n">Secret</span> <span class="o">=</span> <span class="s">'Aew6oxx-----------FaTClkjXlmw_zH'</span>
<span class="err">       </span> <span class="n">token_url</span> <span class="o">=</span> <span class="s">'https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid={}&amp;corpsecret={}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">CorpID</span><span class="p">,</span> <span class="n">Secret</span><span class="p">)</span>
<span class="err">       </span> <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="err">       </span> <span class="n">p</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="err">       </span> <span class="n">token</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s">'access_token'</span><span class="p">]</span>
<span class="err">       </span> <span class="k">return</span> <span class="n">token</span>

<span class="err">   </span> <span class="k">def</span> <span class="nf">send_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
<span class="err">       </span> <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_token</span><span class="p">()</span>
<span class="err">       </span> <span class="n">url</span> <span class="o">=</span> <span class="s">'https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token={}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="err">       </span> <span class="n">send_content</span><span class="o">=</span><span class="p">{</span>
<span class="err">           </span> <span class="s">"touser"</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
<span class="err">           </span> <span class="s">"msgtype"</span><span class="p">:</span> <span class="s">"text"</span><span class="p">,</span>
<span class="err">           </span> <span class="s">"agentid"</span><span class="p">:</span> <span class="s">"2"</span><span class="p">,</span>
<span class="err">           </span> <span class="s">"text"</span><span class="p">:</span> <span class="p">{</span>
<span class="err">              </span> <span class="s">"content"</span><span class="p">:</span> <span class="n">msg</span>
<span class="err">           </span> <span class="p">},</span>
<span class="err">           </span> <span class="s">"safe"</span><span class="p">:</span><span class="s">"0"</span>
<span class="err">           </span> <span class="p">}</span>
<span class="err">       </span> 
<span class="err">       </span> <span class="n">p</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">send_content</span><span class="p">))</span>
<span class="err">       </span> <span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">content</span>
<span class="err">       </span> <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"weixin send success"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
<span class="err">   </span> <span class="n">user_id</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="err">   </span> <span class="n">msg</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="err">   </span> <span class="n">weixin</span> <span class="o">=</span> <span class="n">Weixin</span><span class="p">()</span>
<span class="err">   </span> <span class="n">weixin</span><span class="o">.</span><span class="n">send_msg</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
</code></pre></div></div>
</p> -->
  </li>
  
  <li>
    <a href="/2016/06/29/zabbix-monitor-port">zabbix监控指定端口</a>
   <!-- <p><p>1.登陆zabbix主界面</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/04/13/deploy-zabbix_agent-to-windows">window系统上部署Zabbix_agent</a>
   <!-- <p><p>1.获取windows的agent客户端，解压文件至指定位置</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/03/25/zentaopms-deployment">Zentaopms部署</a>
   <!-- <p><ol>
  <li>获取软件</li>
</ol>

</p> -->
  </li>
  
  <li>
    <a href="/2016/02/18/Three-shared-storage-comparisons">三种共享存储比较</a>
   <!-- <p><h3 id="共享存储sharestorage类型">共享存储（Share Storage）类型</h3>

</p> -->
  </li>
  
  <li>
    <a href="/2016/02/18/vs-nat-cluster">VS-NAT集群构建</a>
   <!-- <p><p>由于lvs基于内核实现的负载均衡技术，因此主要是在内核层面配置，软件层面需要配置的东西很少。我们是通过软件生成配置文件，再讲配置文件刷到内核中。
```shell
#安装组包
yum groupinstall “Load Balancer”</p>

</p> -->
  </li>
  
  <li>
    <a href="/2016/01/31/transaction-isolation-level">四种事务隔离级别</a>
   <!-- <p><p>数据库系统提供了四种事务隔离级别：</p>

<p>A.Serializable（串行化）：一个事务在执行过程中完全看不到其他事务对数据库所做的更新（事务执行的时候不允许别的事务并发执行。事务串行化执行，事务只能一个接着一个地执行，而不能并发执行。</p>

<p>B.Repeatable Read（可重复读）：一个事务在执行过程中可以看到其他事务已经提交的新插入的记录，但是不能看到其他其他事务对已有记录的更新。</p>

<p>C.Read Commited（读已提交数据）：一个事务在执行过程中可以看到其他事务已经提交的新插入的记录，而且能看到其他事务已经提交的对已有记录的更新。</p>

<p>D.Read Uncommitted（读未提交数据）：一个事务在执行过程中可以看到其他事务没有提交的新插入的记录，而且能看到其他事务没有提交的对已有记录的更新。</p>
</p> -->
  </li>
  
  <li>
    <a href="/2015/10/08/window-force-delete-file">window系统文件或目录无法删除解决方法</a>
   <!-- <p><ol>
  <li>新建.BAT批处理文件输入如下命令，然后将要删除的文件拖放到批处理文件图标上即可删除。</li>
</ol>

</p> -->
  </li>
  
  <li>
    <a href="/2015/08/21/iis-set-urlrewrite">URLRewriter设置Config和IIS配置做伪静态</a>
   <!-- <p><p>一、首先检查config文件里面是否包含这两个节点</p>

</p> -->
  </li>
  
  <li>
    <a href="/2015/08/21/mime-type">常见MIME类型设置方法</a>
   <!-- <p><h3 id="常见mime类型和设置方法">常见MIME类型和设置方法</h3>
<p>当前列举了常用的MIME类型，查询详细：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types">MIME Type</a></p>

</p> -->
  </li>
  
</ul>

    </div>
</div>
		</section>
	</main></body>

</html>