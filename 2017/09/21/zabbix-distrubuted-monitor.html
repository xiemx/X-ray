<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<!-- <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css"> -->
<link rel="shortcut icon" href="/assets/favicon.ico">
<title>zabbix distrubuted monitor</title>
<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>zabbix distrubuted monitor - 求索</title>
<meta property="og:title" content="zabbix distrubuted monitor" />
<meta name="description" content="zabbix 分布式监控2种模式 node模式 proxy模式" />
<meta property="og:description" content="zabbix 分布式监控2种模式 node模式 proxy模式" />
<link rel="canonical" href="http://localhost:4000/2017/09/21/zabbix-distrubuted-monitor" />
<meta property="og:url" content="http://localhost:4000/2017/09/21/zabbix-distrubuted-monitor" />
<meta property="og:site_name" content="求索" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-21T10:09:37+08:00" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "zabbix distrubuted monitor",
"datePublished": "2017-09-21T10:09:37+08:00",
"description": "zabbix 分布式监控2种模式 node模式 proxy模式",
"url": "http://localhost:4000/2017/09/21/zabbix-distrubuted-monitor"}</script>
<!-- End Jekyll SEO tag -->
</head>

<body>
	<main class="container">
		<section class="about">
			<a href="/"><img src="/assets/profile.png" alt="Mingxu.Xie"></a>
			<h2>Mingxu.Xie</h2>
			<p class="tagline">Devops</p>
			<ul class="social">
				<a href="https://github.com/xiemx">
					<li><i class="icon-github-circled"></i></li>
				</a>
				<a href="https://www.linkedin.com/in/xiemx1991">
					<li><i class="icon-linkedin-squared"></i></li>
				</a>
				<a href="https://twitter.com/xiemx1991">
					<li><i class="icon-twitter-squared"></i></li>
				</a>
			</ul>
			<p>&copy; 尔不必求记，却宜求个明白！</p>
			<div>
				<div class="categories">
					<h4>Categories</h4>
					<ul>
						<a href="/">
							<li>Index</li>
						</a>
						<a href="/pages/about.html">
							<li>About</li>
						</a>
						<a href="/pages/archive.html">
							<li>Archive</li>
						</a>
						<a href="/blog/">
							<li>Blogs</li>
						</a>
						<a href="/pages/commands.html">
							<li>Commands</li>
						</a>
					</ul>
				</div>
				<div class="tags" style="width:200px;white-space:normal">
					<h4>Tag Cloud:</h4>
					<a href="/tag/cluster/" class="set-1">cluster</a> <a href="/tag/command/" class="set-1">command</a> <a href="/tag/deployment/" class="set-1">deployment</a> <a href="/tag/domain/" class="set-1">domain</a> <a href="/tag/http/" class="set-1">http</a> <a href="/tag/iis/" class="set-1">iis</a> <a href="/tag/issue/" class="set-1">issue</a> <a href="/tag/memcache/" class="set-1">memcache</a> <a href="/tag/mime-type/" class="set-1">mime-type</a> <a href="/tag/mongo/" class="set-1">mongo</a> <a href="/tag/monitor/" class="set-1">monitor</a> <a href="/tag/mysql/" class="set-1">mysql</a> <a href="/tag/python/" class="set-1">python</a> <a href="/tag/scripts/" class="set-1">scripts</a> <a href="/tag/shell/" class="set-1">shell</a> <a href="/tag/statuscode/" class="set-1">statusCode</a> <a href="/tag/uwsgi/" class="set-1">uwsgi</a> <a href="/tag/vagrant/" class="set-1">vagrant</a> <a href="/tag/vcenter/" class="set-1">vcenter</a> <a href="/tag/windows/" class="set-2">windows</a> <a href="/tag/zabbix/" class="set-5">zabbix</a> <a href="/tag/zentaopms/" class="set-1">zentaopms</a>
				</div>
			</div>
		</section>
		<section class="content">
			<div class="post-container">
  <a class="post-link" href="/2017/09/21/zabbix-distrubuted-monitor">
    <h2 class="post-title">zabbix distrubuted monitor</h2>
  </a>
  <div class="post-meta">
    <ul class="post-categories"><li>zabbix</li></ul>
    <div class="post-date"><i class="icon-calendar"></i>Sep 21, 2017</div>
  </div>
  <div class="post">
    <p>zabbix 分布式监控2种模式</p>
<ul>
  <li>node模式</li>
  <li>proxy模式</li>
</ul>

<p>PS: node模式官方在2.4版本之后已经弃用，重点讨论proxy模式</p>

<h3 id="proxy-模式">proxy 模式</h3>

<p>Zabbix proxy可以代替Zabbix服务器收集性能和可用性数据，一个代理可以承担一些收集数据的负载。使用代理是实现集中式和分布式监控的最简单方法。proxy需要使用单独的数据库来缓存agent数据，在发给server防止出现因网络问题造成的数据丢失。zabbix proxy只是一个数据收集组件，不会触发任何trigger／alert.</p>

<p><img src="/assets/image/img_59c35cd9ab71b.png" alt="img" /></p>

<h3 id="使用场景">使用场景</h3>

<ul>
  <li>Monitor remote locations</li>
  <li>Monitor locations having unreliable communications</li>
  <li>Offload the Zabbix server when monitoring thousands of devices</li>
  <li>Simplify the maintenance of distributed monitoring</li>
</ul>

<h3 id="安装配置">安装配置</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#同安装zabbix server 类似，不赘述,需要其他功能也可以在编译时自行开启。</span>

./configure <span class="nt">--prefix</span><span class="o">=</span>/opt/zabbix_proxy/ <span class="nt">--enable-proxy</span> <span class="nt">--with-mysql</span> <span class="nt">--with-libcurl</span>
make <span class="nb">install

</span>create databases zabbix
grant all to zabbix.<span class="k">*</span> to zabbix@<span class="s1">'%'</span> identified by <span class="s2">"zabbix"</span><span class="p">;</span>
<span class="c">#导入schema.sql</span>

<span class="c">#配置文件中hostname需要和zabbix上添加的保持一致</span>
<span class="c">#其它参考server设置参数</span>

<span class="c">#ps：设置适当的配置同步时间，默认一小时。建议设置短一点，这样如果有新机器加入配置修改都可以快速同步并监控。</span>
<span class="nv">ConfigFrequency</span><span class="o">=</span>600
</code></pre></div></div>

<p>zabbix server 配置</p>

<p><img src="/assets/image/img_59c35d1d930c1.png" alt="img" /></p>

<p>添加主机时选择指定的proxy</p>

<p><img src="/assets/image/img_59c35d389b1c5.png" alt="img" /></p>

  </div>
		</section>
	</main></body>

</html>